<!-- index.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <title>Koken Portal Site</title>
    <meta charset="UTF-8">
    <!-- レスポンシブwebデザインの指定 --><!-- デバイスの横幅合わせ,等倍表示（半角空白入れるな！） -->
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!-- https://fontawesome.com/ -->
    <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./css/style-basic.css">
    <link rel="stylesheet" type="text/css" href="./css/style-index.css">
    <!-- link rel="stylesheet" type="text/css" href="./css/reset.css" -->
    <link rel="icon" href="./images/favicon.ico" sizes="32x32">
	<script type="text/javascript">
    </script>
</head>
<body>
<div>
    <!-- Header -->
	<header>
	    <header1 id="logo"><a href="/">コーケン工業</a></header1>
		<header2 id="menutitle">社内ポータルサイト</header2>
        <header3 id="settings"><a href="settings.html"><img src="./images/settings.png" height="26px"></a></header3>
	</header>

    <!-- contents -->
    <div id="top"></div>
    <div class="containers">
        <div class="item-top">
            <a href="http://www.koken.jpn.com/" target="_blank">
                <img class="topimg" src="./images/koken.png" height="250px" alt="menu1">
            </a>
        </div>
        <!-- ニュースリストは最大６行まで -->
        <div id="news-list">
            <p class="news-list-item"><b>2023-12-23 定時すぎよりケーキを配布いたします</b></p>
            <hr>
            <p class="news-list-item">2023-11-20 安否コールテストがあります。必ず返信してください！</p>
            <hr>
            <p class="news-list-item">2023-11-19 ニュース　ニュース　ニュース　ニュース</p>
            <hr>
            <p class="news-list-item">2023-08-18 〇〇設備メンテナンス 15：00～終日</p>
            <hr>
            <p class="news-list-item">2023-08-18 〇〇設備メンテナンス 15：00～終日</p>
            <hr>
            <p class="news-list-item">2023-08-18 〇〇設備メンテナンス 15：00～終日</p>
            <hr>
        </div>
        <!-- 業務メニュー 2/25現在３つまで(4*1行, 3*1行, 2*2行) -->
        <div class="item-title">
            <i class="fas fa-paw"></i> 業務メニュー
        </div>
        <div class="item">
            <a href="javascript:LeaktestReport('6050');">
                <img class="itemimg" src="./images/S気密さん黄銅さん.png" alt="menu01">
                <div class="itemtext">黄銅洩れ検査</div>
            </a>
        </div>
        <div class="item">
            <a href="javascript:LeaktestReport('6070');">
                <img class="itemimg" src="./images/S気密さん炉中さん.png" alt="menu02">
                <div class="itemtext">炉中洩れ検査</div>
            </a>
        </div>
        <div class="item">
            <a href="javascript:LeaktestReport('6079');">
                <img class="itemimg" src="./images/S炉中ろう付け工程(両面).png" alt="menu03">
                <div class="itemtext">炉中目視検査</div>
            </a>
        </div>
        <div class="item">
            <!-- PC-Edgeでの検証　開く・ダウンロード・コンテント表示・インデックス画像表示はOK -->
            <!-- a href="http://apemsv/PEMasterEM/docspace/sdk/open.do       ?id=APEMSV%3AOYAHINBAN%3A133834989822265&enc=UTF-8" target="_blank" -->
            <!-- a href="http://apemsv/PEMasterEM/docspace/sdk/download.do   ?id=APEMSV%3AOYAHINBAN%3A133834989822265&enc=UTF-8" target="_blank" -->
            <!-- a href="http://apemsv/PEMasterEM/docspace/sdk/contentView.do?id=APEMSV%3AOYAHINBAN%3A133834989822265&enc=UTF-8" target="_blank" -->
            <!-- a href="http://apemsv/PEMasterEM/docspace/sdk/indexView.do  ?id=APEMSV%3AOYAHINBAN%3A133834989822265&enc=UTF-8" target="_blank" -->
            <!-- PC-Chromeでの検証　開く　ダウンロードはOK、コンテント表示・インデックス画像表示はNG -->
            <!--  ⇒ 「DocuWorks Viewerでの表示が指定されていますが、お使いのブラウザではサポートされていません。」 -->
            <!-- iPadから開くapemsv:192.168.96.208 -->
            <!-- a href="http://192.168.96.199:3000/mp" target="_blank" -->
            <!-- div class="itemtext">切 削 工 程</div -->

            <!-- APEM テスト 
            <a href="http://apemsv/PEMasterEM/docspace/sdk/open.do?id=APEMSV%3AOYAHINBAN%3A133834989822265&enc=UTF-8" target="_blank">
                <img class="itemimg" src="./images/mp.png" alt="menu04">
                <div class="itemtext">APEMコンテント表示</div>
            </a>
            -->
            <a href="javascript:ManualSearch()">
                <img class="itemimg" src="./images/本読みの子.png" alt="menu04">
                <div class="itemtext">電子マニュアル</div>
            </a>
        </div>

        <!-- その他サービス 2/25現在１つ -->
        <div class="item-title">
            <i class="fas fa-paw"></i> その他のサービス
        </div>
        <div class="item">
            <a href="./project-quiz-arcweld">
                <img class="itemimg" src="./images/電気溶接.png" alt="menu11">
                <div class="itemtext">MAG溶接クイズ</div>
            </a>
        </div>
        <div class="item">
            <a href="./project-quiz-arcweld/ex/question01.html?011000">
                <img class="itemimg" src="./images/kanji.png" alt="menu12">
                <div class="itemtext">漢字検定(不定期更新)</div>
            </a>
        </div>
        <div class="item">
            <a href="./monitor.html">
                <img class="itemimg" src="./images/sample.png" alt="menu12">
                <div class="itemtext">モニター解像度判定</div>
            </a>
        </div>
    </div>

    <!-- Footer -->
	<footer>
        <a class="goback" href="javascript:history.back()">[戻る]</a>
	    <a class="copyright">&copy; 2023 Koken Kogyo Co. All rights reserved.</a>
        <a class="gotop" href="#">ページの先頭に戻る</a>
    </footer>
</div>
<script type="text/javascript">

    window.onload = function() {
        const hostname = location.hostname;
        const xmlHttpRequest = new XMLHttpRequest();
        xmlHttpRequest.open('GET', `https://${hostname}/cgi-bin/topics.vbs`, false);
        xmlHttpRequest.send();
        if (xmlHttpRequest.readyState == 4 && xmlHttpRequest.status == 200 ) {
            const tag1="<p class='news-list-item'><b>";
            const topics = decodeURI(xmlHttpRequest.responseText).replace("\r","").split("\n");
            const tag2 = "</b></p>";
            const tag3 = "<hr>";
            let tmp = "";
            for (let i = (topics.length - 2); i >= 0; i--) {
                tmp = tmp + `${tag1}${topics[i]}${tag2}\n${tag3}`;
                // if (topics.length > 6) { if (topics.length - 6 > i) {break;} } // MAX6行
            }
            document.getElementById("news-list").innerHTML = tmp;
        } else {
            document.getElementById("news-list").innerTEXT = "読み込み失敗";
        }
    }

    // 電子マニュアル表示システム起動
    function ManualSearch() {
        const hostname = location.hostname;
        // ローカルストレージデータを取得
        const lspdfcd = localStorage.getItem("pdfcd");
        if (lspdfcd == "" || lspdfcd == null) {
            alert("先に設定画面にて設置場所の設定を行ってください．");
            location.href = `./settings.html`;
            return false;
        }
        location.href = `https://${hostname}:53020/${lspdfcd}`;
    }

    // 洩れ検査作業日報支援システム起動
    function LeaktestReport(odc) {

        // JavascriptでOS（Windows・Linux・Mac・iPad・iPhone）を判定
        const ua = window.navigator.userAgent.toLowerCase();
        let myOS = "";
        if (ua.match("windows") !== null) { myOS = "windows"; } else 
        if (ua.match("linux") !== null) { myOS = "linux"; } else 
        if (ua.match("ipad") !== null) { myOS = "ipad"; } else 
        if (ua.match("mac") !== null) { myOS = "mac"; } else 
        if (ua.match("iphone") !== null) { myOS = "iphone"; }
        
        // ローカルストレージデータを取得
        const lsOdcd = localStorage.getItem("odcd");
        const lsUserid = localStorage.getItem("userid");
        const lsPassword = localStorage.getItem("password");
        
        // デバッグ表示
        // alert("OS:" + myOS + "/odcd" + lsOdcd.substring(0, 4) + "/userid:" + lsUserid + "/" + odc);
        
        // <!-- odc:6050 : odcd:60500 -->
        // <!-- odc:6070 : odcd:60707 / 60708 -->
        // <!-- odc:6079 : odcd:60717 / 60718 / 60727 / 60728 -->
        let odcd = "";
        
        // 黄銅洩れ検査起動
        if (odc == "6050") {
            odcd = "60500";
        
        // 炉中洩れ検査起動
        } else if (odc == "6070") {
            // ローカルストレージに保存されているodcdと同じボタンが押下された場合に設定値で起動
            if (lsOdcd != null && lsOdcd != "" && odc == lsOdcd.substring(0, 4)) {
                odcd = lsOdcd;
            } else {
                odcd = "60707";
            }

        // 炉中目視検査起動
        } else if (odc == "6079") {
            // ローカルストレージに保存されているodcdと同じボタンが押下された場合に設定値で起動
            if (lsOdcd != null && lsOdcd != "" && (lsOdcd.substring(0, 4) == "6071" || lsOdcd.substring(0, 4) == "6072")) {
                odcd = lsOdcd;
            } else {
                odcd = "60717";
            }
            
        // Default起動
        } else {
            odcd = "60707"
        }

        // 自動ログイン設定を判定
        const hostname = location.hostname;
        if (lsOdcd != null && lsOdcd != "") {
            location.href = `https://${hostname}:53010/direct/${lsUserid}/${lsPassword}/es/${odcd}`;
        } else {
            location.href = `https://${hostname}:53010/es/${odcd}`;
        }

}
</script>
</body>
</html>